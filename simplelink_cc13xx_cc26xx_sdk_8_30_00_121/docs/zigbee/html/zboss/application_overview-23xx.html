<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Application Overview &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
Z-Stack User&#39;s Guide
 8.30.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug zboss application_overview-23xx";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../zigbee-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
Z-Stack User's Guide

          </a>
              <div class="version">
                8.30.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee/overview.html">SimpleLink CC13xx/CC26xx SDK Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee/developing_zigbee_applications.html">Developing Zigbee Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/zigbee-ota-index.html">Zigbee Over-The-Air Firmware Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coexistence/coexistence-ieee.html">Wi-Fi Coexistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee/packet_sniffer.html">Packet Sniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/references-cc13xx_cc26xx.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zigbee-guide/glossary.html">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../zigbee-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
Z-Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../zigbee-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
      <li>Application Overview</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="application-overview">
<h1>Application Overview<a class="headerlink" href="#application-overview" title="Permalink to this headline">¶</a></h1>
<p>Z-Stack example applications are designed to enable faster end-product development by
providing different implementations of Zigbee device definitions while conforming to
<a href="#id7"><span class="problematic" id="id8">|ZCL8|</span></a> requirements for certification.  This allows the
developers to explore the usage of the stack for configuring and running a device in
a network along with other essential features, such as nonvolatile (NV) memory storage
to save the network parameters and application specific information. The configuration
and usage of peripherals such as switches and LEDs are also shown by these
sample applications. This chapter explains the application’s implementation to help
developers quickly modify the Z-Stack out-of-box example applications for customized
development. A full description is proviced in the <a href="#id9"><span class="problematic" id="id10">|ZBOSS_UG|</span></a>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Zigbee stack is not recommended for production.</p>
</div>
<div class="section" id="application-architecture">
<span id="sec-application-architecture"></span><h2>Application Architecture<a class="headerlink" href="#application-architecture" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../zigbee/application_overview.html#fig-example-application-block-diagram"><span class="std std-numref">Figure 45.</span></a> shows the block diagram of the
Light and Switch example applications on the CC13xx and CC26xx.</p>
<div class="figure align-center" id="id5">
<span id="fig-example-application-block-diagram"></span><img alt="../_images/fig-example-application-block-diagram.png" src="../_images/fig-example-application-block-diagram.png" />
<p class="caption"><span class="caption-text">Example Application Block Diagram</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>High-level descriptions of various blocks in <a class="reference internal" href="../zigbee/application_overview.html#fig-example-application-block-diagram"><span class="std std-numref">Figure 45.</span></a>
are as follows:</p>
<p><strong>FreeRTOS Start-up Code:</strong> Initializes the application (see
<a class="reference internal" href="../zigbee/application_overview.html#sec-start-up-in-main"><span class="std std-ref">Start-Up in main()</span></a> for more
details).</p>
<p><strong>Example Application:</strong> The platform-independent implementation of the example
use case. The Z-Stack out-of-box demonstrates two use cases – Light and
Switch. Developers can modify this module’s out-of-box example code for custom
for custom application requirements to quickly develop end products.</p>
<p><strong>Utility Functions:</strong> Provides various platform utilities which the application
can use.  Examples include LED, timers, keys, and so on.</p>
<p><strong>Application-Specific Functions:</strong> Implements platform-specific functions such
as data storage over power cycles (nonvolatile) and provides user interface
functions, such as handling button presses.</p>
<p><strong>ZBOSS API Module (API ZBOSS Module):</strong> This module provides an interface
to the management and data services of the Zigbee stack.</p>
<div class="section" id="application-preprocessor-configuration">
<span id="sec-app-configuration"></span><h3>Application Preprocessor Configuration<a class="headerlink" href="#application-preprocessor-configuration" title="Permalink to this headline">¶</a></h3>
<p>A few preprocessor symbols exist to operate Z-Stack within the project. They are located in the Project Properties as further discussed in the <em>Useful CCS IDE
Settings</em> section of the <a class="reference external" href="../../../zigbee/zstack-quick-start-guide.html">Z-Stack Quick Start Guide</a>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please refer to the preprocessor symbols section of the
<a class="reference external" href="../../../zigbee/zstack-quick-start-guide.html">Z-Stack Quick Start Guide</a> to setup compile options for the project if using IAR.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="start-up-in-main">
<span id="sec-start-up-in-main"></span><h3>Start-Up in main()<a class="headerlink" href="#start-up-in-main" title="Permalink to this headline">¶</a></h3>
<p>The <code class="code docutils literal notranslate"><span class="pre">main()</span></code> function inside of <code class="code docutils literal notranslate"><span class="pre">ti_f3_main.c</span></code> is the application
starting point at runtime. This is where the board is brought up with interrupts
disabled and board-related components are initialized. Tasks in this function
are configured by initializing the necessary parameters, setting their priority,
and initializing the stack size for the application. The primary IEEE address
(programmed by TI) is obtained from the <a class="reference internal" href="../zigbee-guide/glossary.html#term-CCFG"><span class="xref std std-term">CCFG</span></a> area of the flash memory
and TI drivers are initialized.  In the final step, the <code class="docutils literal notranslate"><span class="pre">FreeRTOS</span></code> scheduler is
started by calling <code class="code docutils literal notranslate"><span class="pre">vTaskStartScheduler()</span></code>, which does not return. See the
<a class="reference external" href="https://www.ti.com/lit/pdf/swcu185">CC13x2 CC26x2 SimpleLink Wireless MCU Technical Reference Manual</a> for information on the start-up sequence before <code class="code docutils literal notranslate"><span class="pre">main()</span></code> is reached.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="n">pthread_t</span><span class="w">           </span><span class="kr">thread</span><span class="p">;</span><span class="w"></span>
<span class="n">pthread_attr_t</span><span class="w">      </span><span class="n">attrs</span><span class="p">;</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">sched_param</span><span class="w">  </span><span class="n">priParam</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w">                 </span><span class="n">retc</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w">                 </span><span class="n">detachState</span><span class="p">;</span><span class="w"></span>

<span class="cm">/* Call driver init functions */</span><span class="w"></span>
<span class="n">Board_init</span><span class="p">();</span><span class="w"></span>

<span class="cm">/* Set priority and stack size attributes */</span><span class="w"></span>
<span class="n">retc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_attr_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">attrs</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* pthread_attr_init() failed */</span><span class="w"></span>
<span class="w">        </span><span class="n">FATAL_ERR</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">priParam</span><span class="p">.</span><span class="n">sched_priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="n">detachState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTHREAD_CREATE_DETACHED</span><span class="p">;</span><span class="w"></span>
<span class="n">retc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_attr_setdetachstate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">detachState</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* pthread_attr_setdetachstate() failed */</span><span class="w"></span>
<span class="w">        </span><span class="n">FATAL_ERR</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">retc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_attr_setschedparam</span><span class="p">(</span><span class="o">&amp;</span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">priParam</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* pthread_attr_setschedparam() failed */</span><span class="w"></span>
<span class="w">        </span><span class="n">FATAL_ERR</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">retc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_attr_setstacksize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">THREADSTACKSIZE</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* pthread_attr_setstacksize() failed */</span><span class="w"></span>
<span class="w">        </span><span class="n">FATAL_ERR</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">retc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="kr">thread</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">main_task_function</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* pthread_create() failed */</span><span class="w"></span>
<span class="w">        </span><span class="n">FATAL_ERR</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* Start the FreeRTOS scheduler */</span><span class="w"></span>
<span class="n">vTaskStartScheduler</span><span class="p">();</span><span class="w"> </span><span class="cm">/* does not return */</span><span class="w"></span>

<span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>In terms of the IDE workspace, <code class="docutils literal notranslate"><span class="pre">ti_f3_main.c</span></code> exists in the Application project –
meaning that when compiled it is placed in the allocated section of the application’s flash.</p>
</div>
<div class="section" id="application-initialization-function">
<span id="sec-application-init-function"></span><h3>Application Initialization Function<a class="headerlink" href="#application-initialization-function" title="Permalink to this headline">¶</a></h3>
<p><span class="xref std std-ref">FreeRTOS Tasks</span> describes how a task is constructed. After the
task is constructed and the <code class="docutils literal notranslate"><span class="pre">FreeRTOS</span></code> scheduler is started, the function that
was passed during task construction is run when the task is ready. Specific Z-Stack
functions are called to establish the node processes ans start the device.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">MAIN</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="n">ARGV_UNUSED</span><span class="p">;</span><span class="w"></span>

<span class="cm">/* Trace enable */</span><span class="w"></span>
<span class="n">ZB_SET_TRACE_OFF</span><span class="p">();</span><span class="w"></span>
<span class="cm">/* Traffic dump enable */</span><span class="w"></span>
<span class="n">ZB_SET_TRAF_DUMP_OFF</span><span class="p">();</span><span class="w"></span>

<span class="cm">/* Global ZBOSS initialization */</span><span class="w"></span>
<span class="n">ZB_INIT</span><span class="p">(</span><span class="s">&quot;on_off_switch&quot;</span><span class="p">);</span><span class="w"></span>


<span class="cp">#ifdef ZB_COORDINATOR_ROLE</span>
<span class="cm">/* Set up defaults for the commissioning */</span><span class="w"></span>
<span class="n">zb_set_long_address</span><span class="p">(</span><span class="n">g_zc_addr</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_set_network_coordinator_role</span><span class="p">(</span><span class="n">DEFAULT_CHANLIST</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_secur_setup_nwk_key</span><span class="p">(</span><span class="n">g_nwk_key</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_set_max_children</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="cp">#elif defined ZB_ROUTER_ROLE &amp;&amp; !defined ZB_COORDINATOR_ROLE</span>
<span class="cm">/* Set up defaults for the commissioning */</span><span class="w"></span>
<span class="n">zb_set_long_address</span><span class="p">(</span><span class="n">g_zr_addr</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_set_network_router_role</span><span class="p">(</span><span class="n">DEFAULT_CHANLIST</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_set_max_children</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="cp">#elif defined ZB_ED_ROLE</span>
<span class="cm">/* Set up defaults for the commissioning */</span><span class="w"></span>
<span class="n">zb_set_long_address</span><span class="p">(</span><span class="n">g_zed_addr</span><span class="p">);</span><span class="w"></span>
<span class="n">zb_set_network_ed_role</span><span class="p">(</span><span class="n">DEFAULT_CHANLIST</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Set end-device configuration parameters */</span><span class="w"></span>
<span class="n">zb_set_ed_timeout</span><span class="p">(</span><span class="n">ED_AGING_TIMEOUT_64MIN</span><span class="p">);</span><span class="w"></span>
<span class="c1">// zb_set_keepalive_timeout(ZB_MILLISECONDS_TO_BEACON_INTERVAL(3000));</span>
<span class="n">zb_set_rx_on_when_idle</span><span class="p">(</span><span class="n">ZB_TRUE</span><span class="p">);</span><span class="w"></span>
<span class="cp">#endif</span>


<span class="n">zb_set_nvram_erase_at_start</span><span class="p">(</span><span class="n">ZB_FALSE</span><span class="p">);</span><span class="w"></span>
<span class="cm">/* Register device ZCL context */</span><span class="w"></span>
<span class="n">ZB_AF_REGISTER_DEVICE_CTX</span><span class="p">(</span><span class="o">&amp;</span><span class="n">on_off_switch_ctx</span><span class="p">);</span><span class="w"></span>
<span class="cm">/* Register cluster commands handler for a specific endpoint */</span><span class="w"></span>
<span class="n">ZB_AF_SET_ENDPOINT_HANDLER</span><span class="p">(</span><span class="n">ZB_SWITCH_ENDPOINT</span><span class="p">,</span><span class="w"> </span><span class="n">zcl_specific_cluster_cmd_handler</span><span class="p">);</span><span class="w"></span>

<span class="cm">/* Initiate the stack start without starting the commissioning */</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">zboss_start_no_autostart</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">RET_OK</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">TRACE_MSG</span><span class="p">(</span><span class="n">TRACE_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zboss_start failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">FMT__0</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">else</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* Call the application-specific main loop */</span><span class="w"></span>
<span class="w">        </span><span class="n">my_main_loop</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* Deinitialize trace */</span><span class="w"></span>
<span class="n">TRACE_DEINIT</span><span class="p">();</span><span class="w"></span>

<span class="n">MAIN_RETURN</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>For application examples, <code class="code docutils literal notranslate"><span class="pre">MAIN</span></code> calls <code class="code docutils literal notranslate"><span class="pre">ZB_INIT()</span></code>,
which later calls <code class="code docutils literal notranslate"><span class="pre">zb_init</span></code> that serves as the entrance for
the application code to configure Z-Stack network parameters as well as
application specific peripherals configurations, callbacks, and stack
notifications.</p>
</div>
<div class="section" id="event-processing-in-the-task-function">
<span id="sec-event-processing-task-function"></span><h3>Event Processing in the Task Function<a class="headerlink" href="#event-processing-in-the-task-function" title="Permalink to this headline">¶</a></h3>
<p>After initializing the peripherals and configuring the application and
implementing the initialization function from the previous code snippet,
<code class="code docutils literal notranslate"><span class="pre">MAIN()</span></code>, it enters an infinite loop <code class="code docutils literal notranslate"><span class="pre">my_main_loop</span></code> so as to
continuously process as an independent task and not run to completion, seen
in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-switch-task-flow-chart</span></code>.</p>
<div class="figure align-center" id="id6">
<span id="fig-switch-task-flow-chart"></span><p class="plantuml">
<img src="../_images/plantuml-35fa8c4ec37c27a48d948d7716de58c3d70d7c84.png" alt="&#64;startuml
:MAIN();
:ZB_INIT()]
:my_main_loop()]
    repeat
    while(Process Zigbee messages)
    :Process Application peripheral events]
    :Process Application events]
    endwhile (No events to process)
    repeat while
:End;
&#64;enduml"/>
</p>
<p class="caption"><span class="caption-text">Switch Example Application Task Flow Chart</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p><code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-switch-task-flow-chart</span></code> shows various reasons for posting to the
semaphore, causing the task to become active.</p>
</div>
<div class="section" id="events-signaled-through-the-internal-event-variable">
<span id="sec-events-signaled-through-internal-event-variable"></span><h3>Events Signaled Through the Internal Event Variable<a class="headerlink" href="#events-signaled-through-the-internal-event-variable" title="Permalink to this headline">¶</a></h3>
<p>The <code class="code docutils literal notranslate"><span class="pre">zboss_signal_handler</span></code> function uses definitions to identify what action
caused the process to wake up and take appropriate action. The values correspond
to a defined event such as (not a comprehensive list):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Application Events</span>
<span class="cp">#define ZB_ZDO_SIGNAL_SKIP_STARTUP            1U</span>
<span class="cp">#define ZB_ZDO_SIGNAL_DEVICE_ANNCE            2U</span>
<span class="cp">#define ZB_ZDO_SIGNAL_LEAVE                   3U</span>
<span class="cp">#define ZB_ZDO_SIGNAL_ERROR                   4U</span>
<span class="cp">#define ZB_BDB_SIGNAL_DEVICE_FIRST_START      5U</span>
<span class="cp">#define ZB_BDB_SIGNAL_DEVICE_REBOOT           6U</span>
<span class="cp">#define ZB_BDB_SIGNAL_STEERING                10U</span>
<span class="cp">#define ZB_COMMON_SIGNAL_CAN_SLEEP            13U</span>
<span class="cp">#define ZB_ZDO_SIGNAL_PRODUCTION_CONFIG_READY 23U</span>
<span class="cp">#define ZB_BDB_SIGNAL_TC_REJOIN_DONE          58U</span>
</pre></div>
</div>
<p>These allow for action to be taken at the time each event occurs.</p>
</div>
<div class="section" id="callbacks">
<span id="sec-callbacks"></span><h3>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h3>
<p>The application code also likely includes various callbacks from the protocol
stack layer and <a class="reference internal" href="../zigbee-guide/glossary.html#term-RTOS"><span class="xref std std-term">RTOS</span></a> modules. These have been registered during the
<code class="code docutils literal notranslate"><span class="pre">MAIN</span></code> or <code class="code docutils literal notranslate"><span class="pre">zboss_signal_handler</span></code> functions.  Examples include
<code class="code docutils literal notranslate"><span class="pre">finding_binding_cb</span></code>, <code class="code docutils literal notranslate"><span class="pre">zcl_specific_cluster_cmd_handler</span></code>,
<code class="code docutils literal notranslate"><span class="pre">button_press_handler</span></code>, and <code class="code docutils literal notranslate"><span class="pre">permit_joining_cb</span></code>.</p>
</div>
<div class="section" id="buttons">
<h3>Buttons<a class="headerlink" href="#buttons" title="Permalink to this headline">¶</a></h3>
<p>The basic common user interface controls the funtionality of a push button which
is already incorporated into the example applications for use with the LaunchPad
boards:</p>
<ul class="simple">
<li><p>BTN-1: Application-specific function (ex. onoff switch)</p></li>
</ul>
<p>More DIOs can be added to fit the requirements of a custom board design and
specific application in accordance with SysConfig initialization, for more
information refer to <a class="reference internal" href="../sysconfig/sysconfig-board.html#sysconfig-board-files"><span class="std std-ref">Configure The Board Files with SysConfig</span></a></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2005-2024, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>