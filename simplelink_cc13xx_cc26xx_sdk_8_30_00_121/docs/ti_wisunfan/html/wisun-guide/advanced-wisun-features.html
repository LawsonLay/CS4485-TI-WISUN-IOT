<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced TI Wi-SUN FAN Stack Features &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User&#39;s Guide
 3.30.00.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Wi-SUN Network Topology Management" href="network-management.html" />
    <link rel="prev" title="FCC Certification Considerations" href="../cc13xx_cc26xx/fcc-certification.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug wisun-guide advanced-wisun-features";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User's Guide

          </a>
              <div class="version">
                3.30.00.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/wisun-quick-start.html">Wi-SUN Stack Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="freertos-index.html">FreeRTOS (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="wisun-index.html">TI Wi-SUN FAN Stack</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced TI Wi-SUN FAN Stack Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wi-sun-compliance">Wi-SUN Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rapid-join">Rapid Join</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disconnect-detection-time">Disconnect Detection Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#production-test-mode-wi-sun-direct-tx-rx">Production Test Mode (Wi-SUN Direct TX/RX)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-shared-network-keys">Pre-shared Network Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#join-to-specific-border-router-eui-based-controlled-device-joining">Join to Specific Border Router/EUI based Controlled Device Joining</a></li>
<li class="toctree-l2"><a class="reference internal" href="#low-latency-multicast">Low Latency Multicast</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="network-management.html">Wi-SUN Network Topology Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="NWP_interface.html">TI Wi-SUN FAN NWP Interface Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-applications.html">Example Application Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="wisun-oad-index.html">MCUBoot Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration-guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html#terms-and-acronyms">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Advanced TI Wi-SUN FAN Stack Features</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="advanced-stack-features">
<span id="sec-wisun-adv-features"></span><h1>Advanced TI Wi-SUN FAN Stack Features<a class="headerlink" href="#advanced-stack-features" title="Permalink to this headline">¶</a></h1>
<p>The following section outlines advanced features that can benefit specific applications.
This section describes the features and how to use them in your application.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some of these features are not compliant with Wi-SUN FAN Specification.
So it is up to the user to decide if they want their product to be compliant, they
should only use the subset of the features which are Wi-SUN FAN compliant.</p>
</div>
<div class="section" id="wi-sun-compliance">
<h2>Wi-SUN Compliance<a class="headerlink" href="#wi-sun-compliance" title="Permalink to this headline">¶</a></h2>
<p>The default out of the box examples of TI Wi-SUN FAN Stack are Wi-SUN compliant.
Some of the advanced features that can be enabled in the application can break compliance.
The following <a class="reference internal" href="#tab-wisun-compliance"><span class="std std-numref">Table 10.</span></a> lists the features and mentions if it is Wi-SUN compliant or not.
The descriptions of each feature is in the subsequent section.</p>
<span id="tab-wisun-compliance"></span><table class="docutils align-center" id="id8">
<caption><span class="caption-number">Table 10. </span><span class="caption-text">Wi-SUN compliance of the advanced features.</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature Name</p></th>
<th class="head"><p>Wi-SUN Compliance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#rapid-join">Rapid Join</a></p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#disconnect-detection-time">Disconnect Detection Time</a></p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#production-test-mode-wi-sun-direct-tx-rx">Production Test Mode (Wi-SUN Direct TX/RX)</a></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pre-shared-network-keys">Pre-shared Network Keys</a></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#join-to-specific-border-router-eui-based-controlled-device-joining">Join to Specific Border Router/EUI based Controlled Device Joining</a></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#low-latency-multicast">Low Latency Multicast</a></p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
<p>The user can enable and disable the following features in TI Wi-SUN FAN module of SysConfig.</p>
<div class="figure align-center" id="id9">
<span id="fig-wisun-adv-features"></span><img alt="../_images/advanced_features.png" src="../_images/advanced_features.png" />
<p class="caption"><span class="caption-number">Figure 28. </span><span class="caption-text">Advanced Wi-SUN Feature Selection in SysConfig</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="rapid-join">
<span id="id2"></span><h2>Rapid Join<a class="headerlink" href="#rapid-join" title="Permalink to this headline">¶</a></h2>
<p>If Rapid join is enabled, TI Wi-SUN FAN timers are optimized for join time.
There are several timers in the Wi-SUN can stack that determine the performance of the stack.
This feature is enabled by default on all the TI Wi-SUN FAN Stack projects. Can be enabled or disabled in SysConfig.
The benefit of this feature is mostly seen in networks of 50 devices or less and comes at the cost of
higher network utilization and power consumption.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the network size is larger, the rapid join feature will be less effective due to higher network traffic.
In a network with high data density, enabling rapid join may affect data latency.</p>
</div>
</div>
<div class="section" id="disconnect-detection-time">
<span id="id3"></span><h2>Disconnect Detection Time<a class="headerlink" href="#disconnect-detection-time" title="Permalink to this headline">¶</a></h2>
<p>This feature can be adjusted in SysConfig. The setting called Router Node Disconnect Disconnection Time on SysConfig
enables the user to set a timer for Border Router (BR) to remove unresponsive nodes from the routing table.
On the Router Nodes (RN), the setting called Border Router Disconnect Disconnection Time on SysConfig allows the user to
set a timer to detect if a BR is down and initiates the search and join process to other BR networks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The timers need to have the same values in the BR and the RN but don’t have to be equal
to each other.</p>
</div>
</div>
<div class="section" id="production-test-mode-wi-sun-direct-tx-rx">
<span id="id4"></span><h2>Production Test Mode (Wi-SUN Direct TX/RX)<a class="headerlink" href="#production-test-mode-wi-sun-direct-tx-rx" title="Permalink to this headline">¶</a></h2>
<p>This feature enables the user to get ping responses within a few seconds of device start.
The production test mode is enabled on the Border Router (BR) through a py-spinel command. On the Router Node (RN),
no changes are necessary. Once the BR is in the production test mode (Wisun Direct Mode),
the ping command can be used with the MAC address of the RN in the vicinity instead of its IPv6 address.
The use of MAC address instead of IPv6 address allows the RN to respond to ping requests very early in the join
process.</p>
<p>This feature is useful when you have the list of MAC addresses of a batch of RN you want to test
and you are looking for a way to check if the RN are capable of joining a Wi-SUN network and respond
to BR messages. This feature allows to perform this check without needing to wait for
a full Wi-SUN join process.</p>
<p>Using pre-shared MAC security keys allows the RN to respond to ping requests from the BR
as soon as it receives PAN Advertisement Frames. This would be join state 2 mentioned in the <a class="reference internal" href="../wisun-stack/join_process.html#sec-wisun-node-join"><span class="std std-ref">Join Process</span></a> section.
It is not Wi-SUN specification compliant to use pre-shared MAC keys.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The BR does not transmit PAN Configuration Frames in this mode, thus will not function as a
fully functioning BR. But the RN need no modification or special modes. It only needs to
use pre-shared MAC keys. It functions as a fully functioning RN.</p>
</div>
</div>
<div class="section" id="pre-shared-network-keys">
<span id="id5"></span><h2>Pre-shared Network Keys<a class="headerlink" href="#pre-shared-network-keys" title="Permalink to this headline">¶</a></h2>
<p>In a typical Wi-SUN join process, EAPOL protocol is used for exchanging security keys and the Border Router (BR)
is responsible to refresh these security keys periodically. While using the pre-shared security keys,
the EAPOL exchange stage is not needed anymore, this results in shorter join times.
You can use SysConfig to enable this feature and load the pre-shared key that will be compiled into the firmware.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In this mode, you only have MAC layer security. And the keys are never refreshed throughout the network’s
lifetime.</p>
</div>
</div>
<div class="section" id="join-to-specific-border-router-eui-based-controlled-device-joining">
<span id="id6"></span><h2>Join to Specific Border Router/EUI based Controlled Device Joining<a class="headerlink" href="#join-to-specific-border-router-eui-based-controlled-device-joining" title="Permalink to this headline">¶</a></h2>
<p>This feature can be enabled in SysConfig and can be used only when using pre-shared keys.
It needs to be enabled/disabled in all devices in the network. This feature allows the user
to filter the Router Nodes (RN) allowed to join a Border Router’s (BR) network.
During the joining process, the RN’s Extended Unique Identifier/MAC address is checked against the
list of allowed devices and only allowed if the RN is in the allow list.
The user is free to choose how to supply the list of allowed devices to the BR.</p>
<p>When the feature is enabled, the callback function bool <cite>customAuthCheckAllowedJoin(uint8_t* eui)</cite> is called on
the BR when the custom join request message has been received via EAPOL protocol. The function is used to
determine whether a joining device is allowed to join. The eui parameter is the EUI of the joining device.
The function should return true if the BR allows this device to join the current network.
The function is weakly defined in ws_bootstrap.c to allow all devices, but can be overwritten by users to
accept/reject devices with specific EUIs.</p>
</div>
<div class="section" id="low-latency-multicast">
<span id="id7"></span><h2>Low Latency Multicast<a class="headerlink" href="#low-latency-multicast" title="Permalink to this headline">¶</a></h2>
<p>Multicast messages over the Wi-SUN network follow the MPL (Multicast Protocol for Low-Power and Lossy Networks)
protocol. RFC7331 and Wi-SUN Specification describes this in detail.
The specification puts limits on the timers so that it avoids flooding of multicast messages and optimizes this
for network stability for medium to large networks.
If you need lower latencies of multicast frames, you can enable this feature, which makes the following optimizations</p>
<ol class="arabic simple">
<li><p>Reduction of MPL trickle timers to their lowest value, reducing latency before transmission and forwarding.</p></li>
<li><p>Disabling of initial transmission replays, lowering network flooding.</p></li>
<li><p>Disabling of MPL trickle inconsistency checking, lowering network flooding.</p></li>
</ol>
<p>These optimizations lead to multicast latency average in the order of milliseconds, without this feature, multicast
latencies of up to several seconds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended to reduce the hop limit (recommended 2-4) of multicast frames when using low latency
multicast mode to reduce multicast storms caused by flooding.</p>
</div>
<p>To test the MPL latency you can follow the instructions below to enable the built-in MAC MPL latency tests.</p>
<ol class="arabic simple">
<li><p>Add the following flags to the Router Node (RN) project so that the RN will use trace to print the MAC MPL packet latency.</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>DEBUG_MPL_BROADCAST_BACK_OFF
MBED_TRACE_MAX_LEVEL=1
</pre></div>
</div>
<div class="figure align-center" id="id10">
<span id="fig-sysconfig-mpl-latency"></span><img alt="../_images/SysConfig_MPL-latency.png" src="../_images/SysConfig_MPL-latency.png" />
<p class="caption"><span class="caption-number">Figure 29. </span><span class="caption-text">Add the required predefined symbols in the project properties</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<ol class="arabic simple" start="2">
<li><p>Build the project and flash the RN.</p></li>
<li><p>Wait for the RN to join the Border Router (BR).</p></li>
<li><p>After the RN joins the BR, you can use the following PySpinel command of the BR to start sending MAC MPL packets.</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>testcommand macmpl on
</pre></div>
</div>
<div class="figure align-center" id="id11">
<span id="fig-br-macmpl-on"></span><img alt="../_images/br_macmpl-on.png" src="../_images/br_macmpl-on.png" />
<p class="caption"><span class="caption-number">Figure 30. </span><span class="caption-text">Insert the command in the SpinelCli terminal</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<ol class="arabic simple" start="5">
<li><p>On the RN side, use the UART to monitor the trace information.</p></li>
</ol>
<ul class="simple">
<li><p><strong>Seq:</strong> Each packet has a unique sequence number. If there is a gap in the sequence number, this indicates that a packet has been dropped.</p></li>
<li><p><strong>D(xxx):</strong> This is the MPL latency <cite>xxx</cite> in <cite>ms</cite>.</p></li>
</ul>
<div class="figure align-center" id="id12">
<span id="fig-uart-traceinfo"></span><img alt="../_images/UART-traceInfo.png" src="../_images/UART-traceInfo.png" />
<p class="caption"><span class="caption-number">Figure 31. </span><span class="caption-text">UART log of the RN showing the MPL latency in ms.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>Testing results can be found in the <a class="reference external" href="https://www.ti.com/lit/swra826">app note swra826</a>.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../cc13xx_cc26xx/fcc-certification.html" class="btn btn-neutral float-left" title="FCC Certification Considerations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="network-management.html" class="btn btn-neutral float-right" title="Wi-SUN Network Topology Management" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>